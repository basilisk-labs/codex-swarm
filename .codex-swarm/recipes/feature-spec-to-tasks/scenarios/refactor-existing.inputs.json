{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Task to Roadmap â€” refactor existing",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "roadmap_slug": {
      "type": "string",
      "minLength": 1,
      "pattern": "^[a-z0-9][a-z0-9-]{1,63}$",
      "description": "Short slug for roadmap files and paths."
    },
    "roadmap_title": {
      "type": "string",
      "minLength": 3,
      "maxLength": 140,
      "description": "Human-readable roadmap title."
    },
    "constraints": {
      "type": "string",
      "default": "",
      "description": "Constraints (stack, timelines, prohibitions, compatibility)."
    },
    "non_goals": {
      "type": "string",
      "default": "",
      "description": "Explicit non-goals."
    },
    "acceptance_criteria": {
      "type": "string",
      "default": "",
      "description": "Acceptance criteria (bullet list)."
    },
    "target_scope": {
      "type": "string",
      "enum": [
        "MVP",
        "MVP+",
        "v1"
      ],
      "default": "MVP",
      "description": "Scope ambition level."
    },
    "risk_level": {
      "type": "string",
      "enum": [
        "low",
        "medium",
        "high"
      ],
      "default": "medium",
      "description": "Expected risk level for changes."
    },
    "milestone_count": {
      "type": "integer",
      "minimum": 3,
      "maximum": 10,
      "default": 5,
      "description": "Target number of milestones in the roadmap."
    },
    "repo_paths_allowlist": {
      "type": "array",
      "items": {
        "type": "string",
        "minLength": 1
      },
      "default": [
        "docs/**",
        "src/**",
        ".codex-swarm/**",
        ".github/**"
      ],
      "description": "Paths allowed for reading/writing (recipe policy)."
    },
    "task_batch_size": {
      "type": "integer",
      "minimum": 1,
      "maximum": 30,
      "default": 8,
      "description": "Maximum number of tasks in the first batch."
    },
    "task_granularity": {
      "type": "string",
      "enum": [
        "coarse",
        "normal",
        "fine"
      ],
      "default": "normal",
      "description": "Task detail level."
    },
    "output_dir": {
      "type": "string",
      "default": "docs/roadmaps",
      "description": "Output directory for roadmap files (repo-relative)."
    },
    "runs_dir": {
      "type": "string",
      "default": ".codex-swarm/.runs",
      "description": "Directory for run artifacts."
    },
    "existing_paths": {
      "type": "array",
      "items": {
        "type": "string",
        "minLength": 1
      },
      "minItems": 1,
      "description": "Files or directories in the current implementation."
    },
    "pain_points": {
      "type": "string",
      "minLength": 20,
      "description": "What is broken and why (symptoms + root causes)."
    },
    "compat_constraints": {
      "type": "string",
      "default": "",
      "description": "Backward-compatibility constraints (APIs, migrations, formats)."
    }
  },
  "required": [
    "roadmap_slug",
    "roadmap_title",
    "existing_paths",
    "pain_points"
  ]
}
